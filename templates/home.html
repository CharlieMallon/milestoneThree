{% extends "base.html" %}

{% block content %}

    <!-- If not logged in show this screen -->
    {% if  session.user == 'none' %}
        <div class="cta">
            <h2>The To Do App to aid recovery</h2>
            <p class="btn cta-btn">Take the first step</p>
        </div>
        <div class="cta cta-right">
            <div class="smallcta">
                <h3>Built to assist</h3>
                <p>Aid you on your road to recovery</p>
                <p class="btn cta-btn">Start Now</p>
            </div>
        </div>
        <div class="cta cta-left">
            <div class="smallcta">
                <h3>Simple Design</h3>
                <p>Designed to work seamlessly between devices</p>
                <p class="btn cta-btn">Start Now</p>
            </div>
        </div>
        <div class="cta cta-right">
            <div class="smallcta">
                <h3>Title</h3>
                <p>text about the title</p>
                <p class="btn cta-btn">Start Now</p>
            </div>
        </div>
        <div class="cta">
            <h3>Final call to action</h3>
            <p class="btn cta-btn">Start Now</p>
        </div>
    {% endif %}
    
    <!-- List out the tasks -->
    {% if  not session.user == 'none' %}
        {% if tasks|length > 0 %}
            <ul class='task'>    
                {% for task in tasks %}
                    {% if session.user|lower == task.created_by|lower %}
                        {% if task.task_size == 'small' %}
                            {% if task.is_done == true %}
                                <li class='task-card col small done'>
                            {% else %}
                                <li class='task-card col small'>
                            {% endif %}   
                        {% elif task.task_size == 'medium' %}
                            {% if task.is_done == true %}
                                <li class='task-card col medium done'>
                            {% else %}
                                <li class='task-card col medium'>
                            {% endif %}
                        {% else %}
                            {% if task.is_done == true %}
                                <li class='task-card col large done'>
                            {% else %}
                                <li class='task-card col large'>
                            {% endif %}
                        {% endif %}
                                <div class='task-header row'>
                                    <div class='row done-box'>
                                        <a href='{{ url_for("done_task", task_id=task._id) }}' class='check-box'>
                                            {% if task.is_done == true %}
                                                <img src='{{ url_for("static", filename="imgs/check-box-empty.svg") }}'></img>
                                            {% else %}
                                                <img src='{{ url_for("static", filename="imgs/check-box-full.svg") }}'></img>
                                            {% endif %}
                                        </a>
                                    </div>
                                    <div class='row task-header-internal'>
                                        <div class='task-name'>
                                            <strong>{{ task.task_name }}</strong>
                                        </div>
                                        <div class="buttons">
                                            <img class='arrow' src='{{ url_for("static", filename="imgs/down-arrow.svg") }}'></img></p>
                                            {% if task.is_priority == true %}
                                            <img src='{{ url_for("static", filename="imgs/priority-high.svg") }}'></img>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <div class='task-body col'>
                                    <div class='task-content-row row info'>
                                        <div class='category'>
                                            {% if task.category_name == '' %}
                                            <strong>
                                                <p>No Category</p>
                                            </strong>
                                            {% else %}
                                            <strong>
                                                {{ task.category_name }}
                                            </strong>
                                            {% endif %}
                                        </div>
                                        <a href='{{ url_for("priority_task", task_id=task._id) }}' class='check-box row'>
                                            {% if task.is_priority == true %}
                                            <img src='{{ url_for("static", filename="imgs/check-box-empty.svg") }}'></img>
                                            {% else %}
                                            <img src='{{ url_for("static", filename="imgs/check-box-full.svg") }}'></img>
                                            {% endif %}
                                            <p class="priority">Priority</p>
                                        </a>
                                    </div>
                                    <div class='task-content-row row'>
                                        {% if task.task_description != '' %}
                                        <div class='description'>
                                            {{ task.task_description }}
                                        </div>
                                        {% endif %}
                                    </div>
                                    <div class='task-content-row row info'>
                                        <div class='due-date'>
                                            {% if task.due_date != 'None' %}
                                                <p>Due by: <span class='date'>{{ task.due_date }}</span></p>
                                            {% else %}
                                                <p>No Due Date</p>
                                            {% endif %}
                                        </div>
                                        <div class="task-buttons">
                                            <div class='open-modal'>
                                                <p class="delete-task"><img src='{{ url_for("static", filename="imgs/delete.svg") }}'></img>
                                            </div>
                                            <!-- The Delete Task Modal -->
                                            <div class="modal-background hidden" data-closer="close">
                                                <!-- Modal content -->
                                                <div class="modal">
                                                    <div class="modal-title">
                                                        <h2>Delete Task<span class="close" data-closer="close">&times;</span></h2>
                                                    </div>
                                                    <div class="modal-content">
                                                        <div class="modal-par">
                                                            <p>Are you sure you want to delete "{{ task.task_name }}"?</p>
                                                        </div>
                                                        <div class="modal-btns">
                                                            <div class="btn m-btn">
                                                                <a href='{{ url_for("delete_task", task_id=task._id) }}'>Yes</a>
                                                            </div>
                                                            <div class="btn m-btn">
                                                                <p class="no-btn" data-closer="close">No</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='edit'>
                                                <a href='{{ url_for("edit_task", task_id=task._id) }}'>
                                                    <img src='{{ url_for("static", filename="imgs/edit.svg") }}'></img>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        {% endif %}
                {% endfor %}
            </ul>
        {% else %}
            <h3>No To Do's found</h3>
        {% endif %}
    {% endif %}


    {% endblock %}